#!/usr/bin/env Rscript
source('common.r')

# j <- '{ "0": 33729, "10": 31, "20": 25, "30": 26, "40": 18, "50": 14, "60": 14, "70": 17, "80": 18, "90": 22, "100": 10, "110": 18, "120": 16, "130": 11, "140": 10, "150": 2, "160": 13, "170": 10, "180": 14, "190": 9, "200": 10, "210": 9, "220": 13, "230": 10, "240": 15, "250": 9, "260": 6, "270": 5, "280": 8, "290": 9, "300": 10, "310": 5, "320": 10, "330": 11, "340": 11, "350": 5, "360": 7, "370": 3, "380": 5, "390": 9, "400": 6, "410": 4, "420": 6, "430": 9, "440": 10, "450": 10, "460": 2, "470": 8, "480": 6, "490": 5, "500": 7, "510": 7, "520": 4, "530": 6, "540": 1, "550": 6, "560": 5, "570": 5, "580": 5, "590": 3, "600": 1, "610": 4, "620": 3, "630": 2, "650": 3, "680": 6, "690": 5, "700": 2, "710": 1, "720": 2, "730": 1, "740": 7, "760": 3, "770": 2, "780": 5, "790": 6, "810": 6, "820": 4, "830": 3, "840": 1, "850": 1, "860": 1, "870": 4, "880": 1, "890": 1, "900": 3, "910": 2, "920": 1, "930": 1, "940": 2, "950": 4, "960": 1, "980": 4, "990": 2, "1000": 2, "1010": 5, "1020": 1, "1030": 3, "1050": 1, "1090": 3, "1110": 5, "1140": 1, "1150": 4, "1160": 1, "1180": 3, "1190": 2, "1200": 2, "1210": 2, "1220": 1, "1230": 1, "1250": 2, "1290": 1, "1300": 1, "1310": 1, "1320": 1, "1340": 2, "1350": 1, "1360": 1, "1390": 1, "1400": 2, "1410": 1, "1430": 1, "1440": 1, "1450": 1, "1470": 1, "1480": 1, "1490": 1, "1500": 2, "1510": 1, "1520": 1, "1560": 1, "1580": 1, "1640": 1, "1710": 1, "1720": 1, "1730": 1, "1770": 1, "1780": 1, "1790": 1, "1800": 1, "1810": 2, "1820": 1, "1840": 1, "2070": 2, "2100": 1, "2120": 1, "2200": 1, "2390": 1, "2430": 1, "2510": 1, "2530": 1, "2630": 1, "2890": 1, "3020": 1, "3240": 1, "3360": 1 }'

# j <- '{ "0": 29015, "10": 2495, "20": 425, "30": 246, "40": 165, "50": 187, "60": 135, "70": 139, "80": 120, "90": 124, "100": 96, "110": 81, "120": 63, "130": 64, "140": 65, "150": 67, "160": 48, "170": 47, "180": 27, "190": 38, "200": 27, "210": 35, "220": 19, "230": 17, "240": 14, "250": 20, "260": 8, "270": 14, "280": 8, "290": 5, "300": 7, "310": 7, "320": 7, "330": 15, "340": 7, "350": 5, "360": 7, "370": 2, "380": 5, "390": 1, "400": 3, "410": 3, "420": 3, "430": 2, "440": 1, "450": 1, "460": 3, "470": 1, "500": 1, "510": 1, "520": 1, "530": 1, "540": 1, "560": 1, "570": 1 }'

# nbids
# j <- '{ "0": 20855, "10": 7665, "20": 3279, "30": 1321, "40": 538, "50": 225, "60": 103, "70": 39, "80": 16, "90": 8, "100": 6, "110": 2, "120": 1, "130": 2, "150": 2, "160": 4, "180": 2, "240": 1, "270": 1, "280": 1, "310": 1 }'

# auction duration:
# j <- jsfix("{'15600': 194, '4300': 63, '16600': 198, '9200': 126, '15900': 206, '3100': 51, '13400': 155, '8300': 122, '11300': 119, '1300': 16, '10100': 137, '5500': 76, '7300': 104, '15200': 216, '6000': 70, '4700': 62, '4900': 73, '12400': 160, '0': 7, '5900': 73, '13000': 150, '2400': 32, '400': 14, '19700': 278, '11700': 135, '8900': 131, '19400': 243, '14100': 167, '2700': 47, '3400': 44, '10200': 137, '9700': 124, '16300': 194, '15500': 192, '18000': 210, '17400': 225, '1700': 18, '13600': 168, '18800': 248, '14500': 174, '9900': 112, '4100': 71, '5300': 77, '11100': 151, '3200': 25, '4400': 57, '7600': 99, '19300': 243, '11900': 151, '8700': 116, '2600': 35, '12300': 153, '10800': 164, '2900': 32, '9600': 121, '19200': 230, '8600': 106, '11800': 130, '700': 12, '12900': 176, '11200': 126, '5600': 75, '17700': 219, '17000': 218, '17900': 214, '6700': 86, '4200': 52, '9300': 127, '16700': 220, '15100': 203, '4800': 66, '12500': 150, '2300': 35, '13300': 182, '10600': 144, '8800': 133, '11600': 138, '18400': 215, '1400': 25, '6300': 102, '5000': 67, '13900': 186, '300': 12, '10700': 149, '19900': 287, '19600': 241, '8200': 93, '15400': 188, '18100': 226, '16400': 215, '9000': 113, '7900': 99, '100': 15, '14600': 214, '900': 14, '11000': 160, '7700': 96, '5400': 81, '3500': 47, '6500': 81, '12000': 154, '17300': 236, '10900': 123, '18900': 246, '1000': 24, '8500': 96, '19500': 248, '18600': 228, '17200': 210, '3800': 58, '10300': 149, '6600': 111, '17800': 231, '14300': 184, '3000': 49, '15000': 181, '3900': 41, '2800': 41, '1900': 36, '2200': 42, '13200': 172, '16800': 232, '5700': 76, '16000': 204, '11500': 168, '18500': 229, '1500': 33, '9400': 118, '6200': 85, '500': 22, '15800': 189, '10400': 140, '3600': 47, '8100': 126, '9500': 127, '16100': 230, '6800': 88, '17600': 239, '14700': 170, '7000': 83, '5100': 74, '13800': 168, '4600': 59, '19100': 252, '12100': 168, '18200': 209, '1800': 30, '1100': 23, '2100': 40, '7400': 108, '17100': 224, '18700': 222, '10000': 135, '600': 19, '7800': 108, '15700': 188, '6900': 80, '1200': 32, '9100': 117, '16500': 196, '8400': 106, '13500': 168, '14200': 185, '16900': 215, '11400': 152, '4000': 72, '7200': 109, '15300': 199, '6100': 73, '14800': 185, '3300': 47, '5800': 81, '13100': 155, '2500': 29, '16200': 216, '200': 12, '17500': 213, '18300': 243, '14000': 189, '14900': 172, '7100': 108, '5200': 75, '19800': 249, '4500': 81, '12800': 163, '12600': 166, '10500': 129, '3700': 62, '8000': 134, '6400': 76, '800': 26, '12700': 167, '1600': 36, '13700': 169, '14400': 173, '9800': 133, '2000': 28, '7500': 98, '19000': 217, '12200': 154}")

# bid time hist:
# j <- jsfix("{'0.9': 18162, '0.8': 12692, '0.34': 2430, '1.1': 220, '0.74': 9873, '0.1': 1070, '0.3': 2005, '0.2': 1439, '0.5': 4499, '0.4': 2857, '0.7': 8767, '0.6': 6106, '0.68': 8089, '0.62': 6617, '0.64': 6941, '0.22': 1652, '0.48': 4159, '0.46': 3829, '0.44': 3510, '0.42': 3278, '0.08': 1073, '0.78': 11787, '0.28': 1960, '0.02': 795, '0.26': 1798, '0.06': 961, '0.04': 886, '0.18': 1411, '0.82': 13485, '0': 964, '0.86': 15900, '0.84': 14689, '0.88': 16976, '0.14': 1259, '0.16': 1315, '0.76': 10858, '0.66': 7510, '0.12': 1206, '0.52': 4831, '0.54': 4924, '0.56': 5427, '0.72': 9343, '0.36': 2563, '0.38': 2717, '0.32': 2229, '0.24': 1773, '0.98': 17546, '0.58': 5909, '0.94': 19210, '0.96': 18983, '0.92': 19206}")

# bid time hist (bidspread=20k)
# j <- jsfix("{'0.9': 11356, '0.8': 9621, '0.34': 4989, '1.1': 124, '0.74': 8686, '0.1': 4086, '0.3': 4638, '0.2': 4258, '0.5': 5982, '0.4': 5273, '0.7': 8083, '0.6': 6929, '0.68': 7745, '0.62': 7189, '0.64': 7465, '0.22': 4224, '0.48': 5807, '0.46': 5599, '0.44': 5348, '0.42': 5419, '0.08': 4131, '0.78': 9159, '0.28': 4520, '0.02': 3973, '0.26': 4291, '0.06': 4136, '0.04': 4345, '0.18': 4075, '0.82': 9934, '0': 4638, '0.86': 10903, '0.84': 10423, '0.88': 11104, '0.14': 4084, '0.16': 4046, '0.76': 9028, '0.66': 7566, '0.12': 4107, '0.52': 6069, '0.54': 6482, '0.56': 6376, '0.72': 8374, '0.36': 4880, '0.38': 5047, '0.32': 4814, '0.24': 4360, '0.98': 8802, '0.58': 6609, '0.94': 11208, '0.96': 10123, '0.92': 11614}")

# bid time hist (bidspread=5k)
# j <- jsfix("{'0.9': 16661, '0.8': 2066, '0.34': 69, '1.1': 690, '0.74': 965, '0.1': 28, '0.3': 73, '0.2': 55, '0.5': 186, '0.4': 108, '0.7': 615, '0.6': 303, '0.68': 549, '0.62': 352, '0.64': 394, '0.22': 51, '0.48': 140, '0.46': 112, '0.44': 115, '0.42': 102, '0.08': 36, '0.78': 1569, '0.28': 63, '0.02': 35, '0.26': 62, '0.06': 23, '0.04': 25, '0.18': 33, '0.82': 2840, '0': 33, '0.86': 5882, '0.84': 3972, '0.88': 9624, '0.14': 28, '0.16': 39, '0.76': 1279, '0.66': 486, '0.12': 34, '0.52': 202, '0.54': 215, '0.56': 224, '0.72': 754, '0.36': 85, '0.38': 80, '0.32': 70, '0.24': 57, '0.98': 140109, '0.58': 242, '0.94': 46919, '0.96': 81215, '0.92': 27823}")

# item views
# j <- jsfix("{'150': 12, '20': 274, '140': 24, '10': 376, '30': 225, '50': 314, '60': 492, '120': 90, '0': 5688, '130': 44, '110': 212, '70': 724, '90': 584, '80': 740, '40': 223, '160': 4, '100': 385}")

# item views (fixed lambda/alpha params)
# j <- jsfix("{'10': 451, '20': 114, '30': 30, '50': 4, '40': 16, '60': 3, '0': 12876}")
# j <- jsfix("{'10': 458, '20': 104, '6': 246, '30': 36, '50': 4, '40': 14, '60': 2, '3': 1320, '1': 6919, '5': 402, '4': 690, '7': 194, '70': 1, '9': 112, '2': 2732, '8': 124}")

# nbids
# j <- '{ "0": 4585, "1": 2281, "2": 2003, "3": 2026, "4": 1757, "5": 1644, "6": 1514, "7": 1423, "8": 1316, "9": 1236, "10": 8040, "20": 3655, "30": 1827, "40": 815, "50": 398, "60": 165, "70": 78, "80": 53, "90": 25, "100": 11, "110": 8, "120": 6, "130": 3, "140": 2, "150": 1, "170": 2, "180": 1, "190": 1, "210": 2, "220": 3, "250": 2, "260": 1 }'

# bid time
# j <- jsfix("{'0.9': 19807, '0.8': 2699, '0.34': 133, '1.1': 875, '0.74': 1247, '0.1': 39, '0.3': 105, '0.2': 78, '0.5': 211, '0.4': 138, '0.7': 831, '0.6': 411, '0.68': 698, '0.62': 478, '0.64': 488, '0.22': 73, '0.48': 176, '0.46': 199, '0.44': 158, '0.42': 172, '0.08': 46, '0.78': 2017, '0.28': 90, '0.02': 34, '0.26': 78, '0.06': 42, '0.04': 37, '0.18': 63, '0.82': 3470, '0': 37, '0.86': 7078, '0.84': 4850, '0.88': 11466, '0.14': 52, '0.16': 61, '0.76': 1590, '0.66': 604, '0.12': 51, '0.52': 248, '0.54': 260, '0.56': 295, '0.72': 1067, '0.36': 140, '0.38': 150, '0.32': 108, '0.24': 73, '0.98': 164736, '0.58': 331, '0.94': 56639, '0.96': 96823, '0.92': 33789}")

# bid time (w/ rnd.item(c))
# j <- jsfix("{'0.9': 5854, '0.8': 5671, '0.34': 4539, '1.1': 188192, '0.74': 5423, '0.1': 3588, '0.3': 4506, '0.2': 3995, '0.5': 5023, '0.4': 4673, '0.7': 5228, '0.6': 5239, '0.68': 5339, '0.62': 5070, '0.64': 5166, '0.22': 4048, '0.48': 4875, '0.46': 4944, '0.44': 4806, '0.42': 4838, '0.08': 3536, '0.78': 5504, '0.28': 4346, '0.02': 3434, '0.26': 4183, '0.06': 3475, '0.04': 3370, '0.18': 3839, '0.82': 5496, '0': 3791, '0.86': 5782, '0.84': 5479, '0.88': 5623, '0.14': 3784, '0.16': 4001, '0.76': 5416, '0.66': 5352, '0.12': 3719, '0.52': 4889, '0.54': 5062, '0.56': 5240, '0.72': 5223, '0.36': 4586, '0.38': 4594, '0.32': 4402, '0.24': 4129, '0.98': 5458, '0.58': 5108, '0.94': 5772, '0.96': 5701, '0.92': 5607}")

# j <- jsfix("{'0.9': 2311, '0.8': 2245, '0.34': 1672, '1.1': 96775, '0.74': 2172, '0.1': 1440, '0.3': 1665, '0.2': 1492, '0.5': 1848, '0.4': 1686, '0.7': 2206, '0.6': 2036, '0.68': 2085, '0.62': 2018, '0.64': 2048, '0.22': 1520, '0.48': 1867, '0.46': 1844, '0.44': 1832, '0.42': 1769, '0.08': 1419, '0.78': 2241, '0.28': 1578, '0.02': 1384, '0.26': 1569, '0.06': 1333, '0.04': 1276, '0.18': 1531, '0.82': 2282, '0': 1542, '0.86': 2400, '0.84': 2338, '0.88': 2448, '0.14': 1462, '0.16': 1452, '0.76': 2214, '0.66': 2035, '0.12': 1404, '0.52': 1993, '0.54': 1956, '0.56': 1966, '0.72': 2088, '0.36': 1676, '0.38': 1751, '0.32': 1648, '0.24': 1612, '0.98': 2499, '0.58': 2039, '0.94': 2453, '0.96': 2476, '0.92': 2426}")

# j <- jsfix("{'0.9': 186, '0.8': 210, '0.34': 81, '1.1': 116, '0.74': 223, '0.1': 78, '0.3': 116, '0.2': 106, '0.5': 215, '0.4': 171, '0.7': 206, '0.6': 195, '0.68': 203, '0.62': 211, '0.64': 225, '0.22': 90, '0.48': 232, '0.46': 188, '0.44': 201, '0.42': 177, '0.08': 60, '0.78': 232, '0.28': 98, '0.02': 64, '0.26': 94, '0.06': 65, '0.04': 51, '0.18': 91, '0.82': 216, '0': 68, '0.86': 195, '0.84': 203, '0.88': 218, '0.14': 84, '0.16': 96, '0.76': 205, '0.66': 227, '0.12': 65, '0.52': 239, '0.54': 210, '0.56': 238, '0.72': 206, '0.36': 111, '0.38': 150, '0.32': 100, '0.24': 117, '0.98': 165, '0.58': 199, '0.94': 233, '0.96': 198, '0.92': 216}")

# nbids_hist
# j <- '{ "0": 7210, "1": 4743, "2": 3493, "3": 2614, "4": 2074, "5": 1722, "6": 1396, "7": 1160, "8": 1075, "9": 849, "10": 4671, "20": 1522, "30": 740, "40": 400, "50": 276, "60": 198, "70": 136, "80": 110, "90": 84, "100": 65, "110": 48, "120": 48, "130": 47, "140": 36, "150": 35, "160": 24, "170": 27, "180": 20, "190": 17, "200": 21, "210": 13, "220": 10, "230": 15, "240": 8, "250": 18, "260": 10, "270": 10, "280": 4, "290": 7, "300": 10, "310": 4, "320": 4, "330": 3, "340": 11, "350": 4, "360": 4, "370": 5, "380": 5, "390": 6, "400": 4, "410": 1, "420": 4, "430": 3, "440": 4, "450": 5, "460": 1, "470": 3, "480": 2, "490": 3, "500": 3, "510": 4, "520": 2, "530": 3, "540": 1, "560": 3, "570": 2, "580": 2, "590": 1, "600": 2, "610": 2, "620": 1, "640": 3, "660": 2, "670": 2, "680": 1, "690": 1, "710": 2, "720": 1, "730": 1, "740": 1, "750": 2, "770": 1, "780": 3, "790": 2, "820": 2, "840": 2, "880": 1, "930": 1, "960": 1, "970": 1, "980": 1, "1020": 1, "1040": 1, "1050": 1, "1080": 1, "1100": 1, "1150": 1, "1240": 2, "1280": 1, "1310": 1, "1360": 1, "1370": 1, "1450": 1, "1500": 1 }'

# j <- jsfix("{'0.9': 186, '0.8': 210, '0.34': 81, '1.1': 116, '0.74': 223, '0.1': 78, '0.3': 116, '0.2': 106, '0.5': 215, '0.4': 171, '0.7': 206, '0.6': 195, '0.68': 203, '0.62': 211, '0.64': 225, '0.22': 90, '0.48': 232, '0.46': 188, '0.44': 201, '0.42': 177, '0.08': 60, '0.78': 232, '0.28': 98, '0.02': 64, '0.26': 94, '0.06': 65, '0.04': 51, '0.18': 91, '0.82': 216, '0': 68, '0.86': 195, '0.84': 203, '0.88': 218, '0.14': 84, '0.16': 96, '0.76': 205, '0.66': 227, '0.12': 65, '0.52': 239, '0.54': 210, '0.56': 238, '0.72': 206, '0.36': 111, '0.38': 150, '0.32': 100, '0.24': 117, '0.98': 165, '0.58': 199, '0.94': 233, '0.96': 198, '0.92': 216}")
# j <- jsfix("{'0.9': 196, '0.8': 229, '0.34': 149, '1.1': 59, '0.74': 201, '0.1': 83, '0.3': 110, '0.2': 95, '0.5': 179, '0.4': 139, '0.7': 224, '0.6': 208, '0.68': 194, '0.62': 179, '0.64': 194, '0.22': 109, '0.48': 124, '0.46': 152, '0.44': 147, '0.42': 160, '0.08': 98, '0.78': 185, '0.28': 123, '0.02': 84, '0.26': 116, '0.06': 87, '0.04': 68, '0.18': 112, '0.82': 212, '0': 76, '0.86': 239, '0.84': 236, '0.88': 217, '0.14': 90, '0.16': 106, '0.76': 194, '0.66': 213, '0.12': 102, '0.52': 160, '0.54': 180, '0.56': 188, '0.72': 208, '0.36': 161, '0.38': 151, '0.32': 134, '0.24': 111, '0.98': 205, '0.58': 194, '0.94': 232, '0.96': 202, '0.92': 208}")

j <- jsfix("{'0': 1515, '1': 1562, '2': 1559, '3': 1563, '4': 1549, '5': 1443, '6': 1420, '7': 1426, '8': 1425, '9': 1429, '10': 1426, '11': 1408, '12': 1445, '13': 1411, '14': 1421, '15': 1416, '16': 1424, '17': 1383, '18': 1400, '19': 1324, '20': 1324, '21': 1370, '22': 1303, '23': 1290, '24': 1407, '25': 1272, '26': 1306, '27': 1314, '28': 1293, '29': 1297, '30': 1332, '31': 1282, '32': 1297, '33': 1312, '34': 1276, '35': 1272, '36': 1238, '37': 1252, '38': 1266, '39': 1241, '40': 1200, '41': 1228, '42': 1183, '43': 1235, '44': 1224, '45': 1242, '46': 1299, '47': 1157, '48': 1197, '49': 1149, '50': 1222, '51': 1220, '52': 1110, '53': 1114, '54': 1125, '55': 1128, '56': 1127, '57': 1180, '58': 1166, '59': 1138, '60': 1119, '61': 1145, '62': 1085, '63': 1053, '64': 1099, '65': 1075, '66': 1060, '67': 1063, '68': 1064, '69': 1084, '70': 1077, '71': 1051, '72': 1063, '73': 1044, '74': 1048, '75': 1023, '76': 1058, '77': 1062, '78': 988, '79': 978, '80': 1036, '81': 970, '82': 1021, '83': 1059, '84': 1003, '85': 980, '86': 1024, '87': 995, '88': 973, '89': 1016, '90': 976, '91': 1000, '92': 969, '93': 992, '94': 904, '95': 937, '96': 957, '97': 966, '98': 904, '99': 879, '100': 988, '101': 934, '102': 921, '103': 886, '104': 915, '105': 915, '106': 891, '107': 888, '108': 898, '109': 887, '110': 881, '111': 894, '112': 846, '113': 896, '114': 880, '115': 854, '116': 893, '117': 860, '118': 848, '119': 835, '120': 872, '121': 814, '122': 820, '123': 793, '124': 852, '125': 843, '126': 831, '127': 861, '128': 847, '129': 852, '130': 830, '131': 778, '132': 850, '133': 773, '134': 795, '135': 784, '136': 805, '137': 759, '138': 744, '139': 786, '140': 769, '141': 793, '142': 813, '143': 776, '144': 733, '145': 739, '146': 759, '147': 747, '148': 719, '149': 752, '150': 726, '151': 781, '152': 732, '153': 682, '154': 717, '155': 692, '156': 753, '157': 741, '158': 724, '159': 753, '160': 705, '161': 719, '162': 739, '163': 729, '164': 706, '165': 688, '166': 669, '167': 764, '168': 693, '169': 694, '170': 622, '171': 630, '172': 683, '173': 621, '174': 662, '175': 671, '176': 661, '177': 675, '178': 648, '179': 618, '180': 667, '181': 637, '182': 625, '183': 615, '184': 612, '185': 624, '186': 629, '187': 641, '188': 670, '189': 614, '190': 632, '191': 627, '192': 602, '193': 609, '194': 620, '195': 631, '196': 576, '197': 601, '198': 554, '199': 575, '200': 583, '201': 568, '202': 594, '203': 565, '204': 527, '205': 608, '206': 554, '207': 555, '208': 540, '209': 535, '210': 576, '211': 535, '212': 558, '213': 553, '214': 558, '215': 517, '216': 575, '217': 569, '218': 529, '219': 564, '220': 523, '221': 558, '222': 521, '223': 526, '224': 477, '225': 511, '226': 536, '227': 577, '228': 535, '229': 488, '230': 500, '231': 519, '232': 453, '233': 504, '234': 467, '235': 464, '236': 493, '237': 483, '238': 510, '239': 481, '240': 458, '241': 459, '242': 475, '243': 510, '244': 500, '245': 464, '246': 510, '247': 455, '248': 462, '249': 463, '250': 468, '251': 467, '252': 491, '253': 450, '254': 477, '255': 436, '256': 453, '257': 469, '258': 405, '259': 497, '260': 431, '261': 412, '262': 432, '263': 424, '264': 454, '265': 427, '266': 436, '267': 410, '268': 465, '269': 420, '270': 403, '271': 434, '272': 367, '273': 427, '274': 401, '275': 390, '276': 427, '277': 389, '278': 439, '279': 392, '280': 402, '281': 401, '282': 411, '283': 402, '284': 397, '285': 398, '286': 414, '287': 389, '288': 406, '289': 391, '290': 412, '291': 411, '292': 392, '293': 359, '294': 328, '295': 375, '296': 390, '297': 395, '298': 346, '299': 360, '300': 359, '301': 400, '302': 369, '303': 329, '304': 365, '305': 353, '306': 373, '307': 362, '308': 338, '309': 393, '310': 392, '311': 368, '312': 339, '313': 349, '314': 328, '315': 345, '316': 336, '317': 342, '318': 359, '319': 322, '320': 353, '321': 331, '322': 362, '323': 337, '324': 325, '325': 300, '326': 314, '327': 334, '328': 282, '329': 324, '330': 336, '331': 314, '332': 320, '333': 283, '334': 301, '335': 305, '336': 317, '337': 327, '338': 339, '339': 328, '340': 331, '341': 341, '342': 294, '343': 309, '344': 313, '345': 289, '346': 292, '347': 250, '348': 282, '349': 284, '350': 290, '351': 304, '352': 297, '353': 284, '354': 291, '355': 269, '356': 294, '357': 273, '358': 317, '359': 293, '360': 269, '361': 282, '362': 293, '363': 272, '364': 285, '365': 279, '366': 294, '367': 291, '368': 260, '369': 260, '370': 262, '371': 258, '372': 288, '373': 256, '374': 286, '375': 248, '376': 248, '377': 247, '378': 251, '379': 254, '380': 254, '381': 244, '382': 247, '383': 259, '384': 244, '385': 244, '386': 261, '387': 224, '388': 251, '389': 268, '390': 234, '391': 225, '392': 233, '393': 235, '394': 248, '395': 212, '396': 238, '397': 219, '398': 208, '399': 242, '400': 254, '401': 192, '402': 232, '403': 209, '404': 207, '405': 239, '406': 234, '407': 227, '408': 220, '409': 225, '410': 214, '411': 230, '412': 208, '413': 230, '414': 230, '415': 203, '416': 190, '417': 212, '418': 201, '419': 207, '420': 232, '421': 233, '422': 219, '423': 218, '424': 207, '425': 194, '426': 187, '427': 213, '428': 239, '429': 179, '430': 205, '431': 195, '432': 205, '433': 192, '434': 206, '435': 213, '436': 193, '437': 192, '438': 184, '439': 191, '440': 182, '441': 182, '442': 200, '443': 182, '444': 152, '445': 192, '446': 173, '447': 181, '448': 198, '449': 207, '450': 207, '451': 166, '452': 182, '453': 193, '454': 169, '455': 196, '456': 163, '457': 178, '458': 156, '459': 180, '460': 181, '461': 170, '462': 165, '463': 159, '464': 168, '465': 169, '466': 163, '467': 198, '468': 141, '469': 181, '470': 182, '471': 158, '472': 176, '473': 145, '474': 156, '475': 137, '476': 174, '477': 154, '478': 175, '479': 151, '480': 170, '481': 168, '482': 157, '483': 125, '484': 177, '485': 161, '486': 140, '487': 157, '488': 145, '489': 140, '490': 144, '491': 134, '492': 150, '493': 177, '494': 155, '495': 137, '496': 129, '497': 167, '498': 164, '499': 149, '500': 164, '501': 130, '502': 137, '503': 131, '504': 148, '505': 126, '506': 124, '507': 149, '508': 149, '509': 139, '510': 140, '511': 124, '512': 110, '513': 129, '514': 118, '515': 112, '516': 135, '517': 143, '518': 136, '519': 143, '520': 139, '521': 141, '522': 161, '523': 146, '524': 118, '525': 129, '526': 112, '527': 130, '528': 129, '529': 104, '530': 144, '531': 140, '532': 133, '533': 131, '534': 147, '535': 114, '536': 133, '537': 126, '538': 122, '539': 110, '540': 119, '541': 118, '542': 120, '543': 106, '544': 123, '545': 124, '546': 128, '547': 117, '548': 111, '549': 113, '550': 128, '551': 116, '552': 125, '553': 113, '554': 105, '555': 107, '556': 114, '557': 111, '558': 102, '559': 114, '560': 109, '561': 118, '562': 113, '563': 105, '564': 120, '565': 101, '566': 111, '567': 113, '568': 95, '569': 101, '570': 128, '571': 101, '572': 113, '573': 112, '574': 89, '575': 105, '576': 108, '577': 102, '578': 89, '579': 99, '580': 100, '581': 100, '582': 97, '583': 114, '584': 100, '585': 92, '586': 106, '587': 113, '588': 95, '589': 100, '590': 92, '591': 83, '592': 105, '593': 97, '594': 102, '595': 87, '596': 87, '597': 104, '598': 87, '599': 81, '600': 82, '601': 85, '602': 92, '603': 86, '604': 84, '605': 82, '606': 86, '607': 90, '608': 84, '609': 87, '610': 79, '611': 90, '612': 85, '613': 90, '614': 89, '615': 75, '616': 68, '617': 82, '618': 86, '619': 88, '620': 79, '621': 73, '622': 81, '623': 72, '624': 82, '625': 66, '626': 77, '627': 90, '628': 83, '629': 87, '630': 75, '631': 93, '632': 75, '633': 73, '634': 78, '635': 75, '636': 88, '637': 92, '638': 77, '639': 81, '640': 71, '641': 74, '642': 71, '643': 72, '644': 86, '645': 85, '646': 77, '647': 98, '648': 77, '649': 79, '650': 71, '651': 78, '652': 64, '653': 62, '654': 66, '655': 70, '656': 82, '657': 90, '658': 70, '659': 61, '660': 48, '661': 46, '662': 65, '663': 59, '664': 61, '665': 63, '666': 65, '667': 64, '668': 69, '669': 81, '670': 66, '671': 72, '672': 67, '673': 65, '674': 78, '675': 65, '676': 71, '677': 63, '678': 67, '679': 69, '680': 66, '681': 62, '682': 58, '683': 58, '684': 69, '685': 53, '686': 53, '687': 54, '688': 59, '689': 54, '690': 46, '691': 45, '692': 55, '693': 64, '694': 55, '695': 53, '696': 60, '697': 51, '698': 43, '699': 61, '700': 70, '701': 52, '702': 53, '703': 55, '704': 64, '705': 48, '706': 53, '707': 65, '708': 50, '709': 57, '710': 45, '711': 40, '712': 52, '713': 42, '714': 49, '715': 55, '716': 57, '717': 47, '718': 60, '719': 44, '720': 53, '721': 46, '722': 36, '723': 40, '724': 36, '725': 35, '726': 49, '727': 35, '728': 52, '729': 32, '730': 41, '731': 37, '732': 33, '733': 35, '734': 39, '735': 35, '736': 22, '737': 25, '738': 24, '739': 26, '740': 18, '741': 30, '742': 35, '743': 28, '744': 22, '745': 22, '746': 26, '747': 22, '748': 19, '749': 28, '750': 18, '751': 22, '752': 26, '753': 6, '754': 21, '755': 11, '756': 21, '757': 26, '758': 9, '759': 10, '760': 12, '761': 18, '762': 9, '763': 16, '764': 17, '765': 15, '766': 12, '767': 13, '768': 8, '769': 16, '770': 14, '771': 6, '772': 13, '773': 7, '774': 13, '775': 7, '776': 6, '777': 6, '778': 10, '779': 6, '780': 8, '781': 5, '782': 6, '783': 6, '784': 5, '785': 9, '786': 6, '787': 7, '788': 5, '789': 10, '790': 9, '791': 8, '792': 6, '793': 3, '794': 4, '795': 6, '796': 4, '797': 5, '798': 7, '799': 1, '800': 3, '801': 3, '802': 2, '803': 5, '804': 5, '805': 2, '806': 3, '809': 1, '810': 5, '811': 2, '812': 4, '813': 5, '814': 1, '815': 3, '816': 1, '818': 1, '819': 2, '820': 1, '822': 1, '823': 1, '827': 1, '830': 1}")

j <- jsfix("{'0': 8752, '1': 8132, '2': 8084, '3': 7679, '4': 7514, '5': 7379, '6': 7123, '7': 7035, '8': 6814, '9': 6537, '10': 6260, '11': 6183, '12': 5989, '13': 5846, '14': 5693, '15': 5706, '16': 5366, '17': 5346, '18': 5016, '19': 4988, '20': 4901, '21': 4844, '22': 4632, '23': 4606, '24': 4440, '25': 4216, '26': 4206, '27': 4137, '28': 3931, '29': 3868, '30': 3823, '31': 3541, '32': 3616, '33': 3462, '34': 3330, '35': 3248, '36': 3229, '37': 3126, '38': 2931, '39': 2877, '40': 2853, '41': 2825, '42': 2666, '43': 2694, '44': 2558, '45': 2647, '46': 2392, '47': 2426, '48': 2252, '49': 2353, '50': 2144, '51': 2049, '52': 2080, '53': 1982, '54': 1980, '55': 1881, '56': 1847, '57': 1834, '58': 1788, '59': 1753, '60': 1652, '61': 1710, '62': 1636, '63': 1576, '64': 1546, '65': 1404, '66': 1505, '67': 1381, '68': 1316, '69': 1322, '70': 1197, '71': 1251, '72': 1209, '73': 1163, '74': 1153, '75': 1102, '76': 1119, '77': 1074, '78': 1039, '79': 977, '80': 967, '81': 964, '82': 918, '83': 895, '84': 879, '85': 800, '86': 837, '87': 791, '88': 812, '89': 829, '90': 764, '91': 731, '92': 673, '93': 708, '94': 668, '95': 643, '96': 640, '97': 594, '98': 612, '99': 599, '100': 566, '101': 537, '102': 558, '103': 534, '104': 531, '105': 510, '106': 467, '107': 464, '108': 488, '109': 471, '110': 402, '111': 432, '112': 415, '113': 413, '114': 386, '115': 367, '116': 382, '117': 383, '118': 355, '119': 315, '120': 339, '121': 327, '122': 316, '123': 286, '124': 298, '125': 290, '126': 300, '127': 289, '128': 279, '129': 238, '130': 251, '131': 264, '132': 263, '133': 249, '134': 245, '135': 224, '136': 219, '137': 204, '138': 184, '139': 202, '140': 202, '141': 171, '142': 164, '143': 176, '144': 178, '145': 158, '146': 156, '147': 172, '148': 148, '149': 146, '150': 143, '151': 152, '152': 118, '153': 128, '154': 128, '155': 130, '156': 104, '157': 124, '158': 109, '159': 131, '160': 116, '161': 109, '162': 102, '163': 126, '164': 116, '165': 106, '166': 108, '167': 90, '168': 106, '169': 90, '170': 83, '171': 75, '172': 72, '173': 77, '174': 71, '175': 79, '176': 84, '177': 68, '178': 77, '179': 62, '180': 67, '181': 61, '182': 52, '183': 64, '184': 64, '185': 52, '186': 64, '187': 63, '188': 40, '189': 54, '190': 51, '191': 36, '192': 44, '193': 38, '194': 46, '195': 51, '196': 30, '197': 37, '198': 47, '199': 47, '200': 46, '201': 41, '202': 28, '203': 26, '204': 36, '205': 37, '206': 36, '207': 40, '208': 38, '209': 32, '210': 38, '211': 28, '212': 26, '213': 18, '214': 16, '215': 25, '216': 28, '217': 27, '218': 24, '219': 30, '220': 22, '221': 26, '222': 25, '223': 21, '224': 17, '225': 18, '226': 20, '227': 19, '228': 20, '229': 14, '230': 19, '231': 16, '232': 14, '233': 14, '234': 15, '235': 11, '236': 19, '237': 18, '238': 20, '239': 13, '240': 14, '241': 18, '242': 12, '243': 14, '244': 11, '245': 16, '246': 8, '247': 12, '248': 7, '249': 6, '250': 11, '251': 7, '252': 9, '253': 9, '254': 10, '255': 7, '256': 7, '257': 7, '258': 5, '259': 5, '260': 6, '261': 5, '262': 7, '263': 10, '264': 7, '265': 6, '266': 5, '267': 6, '268': 6, '269': 6, '270': 6, '271': 7, '272': 3, '273': 5, '274': 3, '275': 3, '276': 8, '277': 6, '278': 4, '279': 7, '280': 5, '281': 7, '282': 7, '283': 5, '284': 4, '285': 3, '286': 4, '287': 1, '288': 3, '289': 6, '290': 1, '291': 3, '292': 4, '293': 2, '294': 4, '295': 2, '296': 3, '297': 3, '298': 2, '299': 5, '301': 4, '302': 3, '303': 2, '304': 3, '305': 1, '306': 4, '307': 1, '309': 2, '310': 1, '311': 1, '312': 1, '313': 2, '314': 4, '316': 2, '317': 2, '319': 2, '321': 3, '322': 1, '324': 1, '325': 2, '326': 2, '327': 1, '329': 1, '330': 2, '331': 1, '332': 1, '334': 1, '336': 1, '338': 1, '339': 1, '343': 2, '344': 2, '349': 1, '350': 1, '352': 1, '353': 1, '355': 1, '356': 2, '358': 2, '360': 1, '365': 1, '366': 1, '368': 1, '369': 2, '370': 1, '371': 1, '374': 1, '376': 2, '378': 1, '384': 1, '390': 1, '394': 1, '398': 1, '432': 1, '507': 1}")

j <- jsfix("{'0': 389, '1': 351, '2': 401, '3': 371, '4': 388, '5': 355, '6': 363, '7': 393, '8': 391, '9': 400, '10': 3705, '20': 3546, '30': 3405, '40': 3263, '50': 2899, '60': 2887, '70': 2794, '80': 2547, '90': 2378, '100': 18099, '200': 10746, '300': 6226, '400': 3648, '500': 2158, '600': 1222, '700': 739, '800': 454, '900': 226, '1000': 338, '2000': 1}")

to.hist <- function(j) {
  l1 <- as.list(fromJSON(j))
  df1 <- data.frame(x=num(names(l1)), y=vals(l1))
  df1 <- df1[order(df1$x),]
}

save(
  ggplot(to.hist(j), aes(x=x, weight=y))+
    geom_histogram(fill=c.blue)+
    theme_mine
, w=3.4, h=2.0)

d <- data.rubis(where="nclients = 4 order by id desc limit 1")

# print(jsfix(d$server_bid_before_close))

bidtime.hist <- to.hist(jsfix(d$server_bid_time_hist))
# bidtime.hist <- to.hist(jsfix(d$server_bid_before_close))

save(
  # ggplot(bidtime.hist, aes(x=-(x/1000), weight=y))+
  ggplot(bidtime.hist, aes(x=x*100, weight=y))+
  xlab('% of auction window time')+
    # geom_histogram(fill=c.blue)+
    geom_line(aes(x=(x+0.02)*100, y=y), color=c.blue)+
    # geom_point(aes(y=y), color=c.blue)+
    # xlab('bid')+ylab('# of bids')+
    # scale_y_log10()+
    # scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1.0,1.1))+
    ylab('# of bids')+
    scale_x_continuous(breaks=c(0,20,40,60,80,100), limits=c(0,100))+
    scale_y_continuous(labels=si.labels())+
    theme_mine
, 'test-bidtime', w=3.4, h=2.0)


nbid.hist <- to.hist(d$stat_nbids_hist)
# scale first 10 items (to account for different bin-widths)
nbid.hist[nbid.hist$x >= 10, ]$y <- nbid.hist[nbid.hist$x >= 10, ]$y/10

save(
  # ggplot(subset(nbid.hist, x != 0), aes(x=x, weight=y))+
  ggplot(nbid.hist, aes(x=x,y=y))+
    geom_point(color=c.blue, size=1.4)+
    xlab('bids / item (log scale)')+ylab('count (log scale)')+
    scale_x_log10(labels=si.labels(), breaks=c(1,10,100,1000,10000))+
    scale_y_log10(labels=si.labels(), breaks=c(1,10,100,1000,10000))+
    theme_mine
, 'test-nbids', w=3.4, h=3.0)

